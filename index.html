<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ã‚¹ãƒ†ã‚¤ãƒ›ãƒ¼ãƒ ãƒ„ã‚¢ãƒ¼ã‚º â€” æ—…è¡Œã‚’ã‚„ã‚ã¦å¹¸ã›ã«å¸°ã‚ã†ï¼ˆå®Œå…¨ç‰ˆï¼‰</title>
<style>
/* RESET */
*{margin:0;padding:0;box-sizing:border-box;font-family:"Noto Sans JP",sans-serif;}
html,body{height:100%;}
body{background:#0b0b0b;color:white;overflow-x:hidden;-webkit-font-smoothing:antialiased;}
.wrapper{max-width:1100px;margin:0 auto;padding:20px;width:100%;}

/* HERO */
.hero{text-align:center;padding:48px 10px 36px;}
.hero h1{font-size:2rem;font-weight:800;margin-bottom:8px;letter-spacing:0.6px;}
.hero p{font-size:1rem;opacity:0.9;margin-bottom:12px;}

/* èµ¤è­¦å‘Šãƒœã‚¿ãƒ³ */
#alertToggle{margin-top:12px;padding:10px 20px;font-size:1rem;border:none;border-radius:50px;background:#b30000;color:white;cursor:pointer;animation:glow 2s infinite;box-shadow:0 0 14px rgba(255,0,0,0.25);}
@keyframes glow{0%{box-shadow:0 0 6px rgba(255,0,0,0.2);}50%{box-shadow:0 0 22px rgba(255,0,0,0.45);}100%{box-shadow:0 0 6px rgba(255,0,0,0.2);}}

/* èµ¤è­¦å‘Šãƒ¢ãƒ¼ãƒ‰ */
.red-alert{background:#2b0000!important;}
.red-alert *{color:#ffb8b8!important;}
.red-alert .pulsing{animation:pulse .6s infinite;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.03);}100%{transform:scale(1);}}

/* layout */
.row{display:flex;gap:18px;flex-wrap:wrap;align-items:flex-start;margin-top:18px;}
.col{flex:1 1 300px;}

/* PLANS */
.plans{margin-top:18px;}
.plans h2{text-align:center;font-size:1.25rem;margin-bottom:12px;}
.controls{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-bottom:12px;}
.controls input, .controls select{padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:#111;color:white;}
.plan-list{display:grid;grid-template-columns:1fr;gap:12px;}
@media(min-width:900px){.plan-list{grid-template-columns:repeat(3,1fr);}}
.plan-card{background:#131313;border-radius:12px;padding:12px;box-shadow:0 0 12px rgba(255,255,255,0.04);text-align:center;transition:.25s;position:relative;overflow:hidden;}
.plan-card:hover{transform:translateY(-6px);box-shadow:0 0 28px rgba(255,255,255,0.06);}
.plan-card img{width:100%;height:140px;object-fit:cover;border-radius:8px;margin-bottom:8px;}
.plan-card .price{font-size:1.05rem;margin:6px 0;color:#ffd166;}
.favorite-btn{position:absolute;top:10px;right:10px;font-size:1.2rem;cursor:pointer; opacity:0.9;padding:6px;border-radius:8px;background:rgba(0,0,0,0.28);}
.favorite-btn.active{color:#ff4d4d;background:rgba(255,255,255,0.03);}

/* ãŠæ°—ã«å…¥ã‚Šãƒšãƒ¼ã‚¸ */
#favoritePage{display:none;padding:12px 0;}
#favoritePage h2{text-align:center;margin-bottom:12px;}
#favoriteList{display:grid;grid-template-columns:1fr;gap:12px;}
@media(min-width:900px){#favoriteList{grid-template-columns:repeat(3,1fr);}}

/* FORM */
.form-section{margin-top:20px;}
.form-section h2{font-size:1.1rem;margin-bottom:10px;}
form{display:flex;flex-direction:column;gap:10px;margin-top:8px;}
input,select,textarea{padding:12px 14px;border:none;border-radius:10px;background:#181818;color:white;font-size:0.98rem;border:1px solid rgba(255,255,255,0.04);}
input::placeholder{opacity:0.6;}
button.submitBtn{padding:12px;background:#00b7ff;border:none;border-radius:10px;color:black;font-size:1rem;cursor:pointer;transition:.2s;}
button.submitBtn:hover{background:#33c8ff;transform:translateY(-2px);}

/* é€ä¿¡ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
.progress-container{width:100%;background:#222;height:12px;border-radius:10px;margin-top:10px;overflow:hidden;display:none;position:relative;}
.progress-bar{height:100%;width:0%;background:linear-gradient(90deg,#00b7ff,#44e0ff,#00b7ff);transition:width 0.18s linear;background-size:200% 100%;}
@keyframes wave {0%{background-position:0 0;}100%{background-position:200% 0;}}

/* ã‚¨ãƒ©ãƒ¼ç”»é¢ */
#errorBox{display:none;margin-top:12px;padding:16px;background:#400;border-left:6px solid red;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.6);}

/* ã‚¨ãƒ©ãƒ¼æŒ¯å‹• */
@keyframes vibrate {
  0%{ transform: translateX(0) }
  20%{ transform: translateX(-8px) }
  40%{ transform: translateX(8px) }
  60%{ transform: translateX(-6px) }
  80%{ transform: translateX(6px) }
  100%{ transform: translateX(0) }
}

/* æˆåŠŸãƒœãƒƒã‚¯ã‚¹ */
.success{display:none;margin-top:12px;padding:16px;background:linear-gradient(135deg,#062,#098);border-left:6px solid #2f6;border-radius:10px;color:#051505;}

/* èŠ±ç«ç”¨ã‚­ãƒ£ãƒ³ãƒã‚¹ï¼ˆãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ï¼‰ */
#fireworksCanvas{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:9999;display:none;}

/* ã‚³ãƒ³ãƒ•ã‚§ãƒ†ã‚£ (è£œåŠ©) */
.confetti{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;overflow:hidden;z-index:9998;}

/* å…¨ãƒœã‚¿ãƒ³å…±é€š */
button, .glow-btn, #alertToggle, .submitBtn{
  border:none;border-radius:12px;padding:8px 14px;font-size:0.95rem;font-weight:700;cursor:pointer;background:linear-gradient(135deg,#1e1e1e,#2c2c2c);color:white;letter-spacing:0.4px;transition:0.2s ease;box-shadow:0 0 10px rgba(255,255,255,0.08);
}

/* èµ¤è­¦å‘Šæ™‚ */
.red-alert button, .red-alert .submitBtn{
  background:linear-gradient(135deg,#4d0000,#7a0000) !important;box-shadow:0 0 14px red !important;
}

/* extra */
.back-btn{display:inline-block;margin-top:12px;background:#444;padding:8px 12px;border-radius:8px;text-decoration:none;color:white;}
.plans-extra{margin-top:20px;display:grid;grid-template-columns:1fr;gap:10px;}
@media(min-width:900px){.plans-extra{grid-template-columns:repeat(2,1fr);}}

/* responsive tweaks */
@media(max-width:640px){
  .hero h1{font-size:1.6rem;}
  .plan-card img{height:120px;}
  .wrapper{padding:12px;}
}
</style>
</head>
<body>
<div class="wrapper">

<section class="hero pulsing">
  <h1>ã‚¹ãƒ†ã‚¤ãƒ›ãƒ¼ãƒ ãƒ„ã‚¢ãƒ¼ã‚º</h1>
  <p>æ—…è¡Œã—ãªã„ã¨ã„ã†æœ€é«˜ã®è´…æ²¢ã€‚ã‚ãªãŸã®å®¶ãŒã€ä»Šæ—¥ã‹ã‚‰ä¸–ç•Œæœ€é«˜ã®è¦³å…‰åœ°ã«ã€‚</p>
  <button id="alertToggle">ğŸ”´ èµ¤è­¦å‘Šãƒ¢ãƒ¼ãƒ‰</button>
  <div style="margin-top:12px;">
    <button id="goFavorite" style="margin-top:6px;padding:8px 14px;font-size:0.95rem;border-radius:10px;border:none;cursor:pointer;background:#ffaa00;color:black;">â­ ãŠæ°—ã«å…¥ã‚Šã‚’è¦‹ã‚‹</button>
    <a href="#" id="backToMain" class="back-btn" style="display:none;">â† å…ƒã®ãƒšãƒ¼ã‚¸ã¸æˆ»ã‚‹</a>
  </div>
</section>

<section class="plans" id="planSection">
  <h2>ãŠã™ã™ã‚åœ¨å®…ãƒ—ãƒ©ãƒ³ï¼ˆè¨ˆ 12 ãƒ—ãƒ©ãƒ³ï¼‰</h2>

  <div class="controls" aria-hidden="false" style="margin-top:8px;">
    <input id="searchInput" type="search" placeholder="æ¤œç´¢ï¼ˆä¾‹ï¼šNetflixã€å¸ƒå›£ã€æ¸©æ³‰ï¼‰" style="min-width:180px;">
    <select id="filterCategory">
      <option value="all">ã‚«ãƒ†ã‚´ãƒª: ã™ã¹ã¦</option>
      <option value="relax">ç™’ã—ç³»</option>
      <option value="comfy">çœã‚¨ãƒç³»</option>
      <option value="wild">å¦„æƒ³ç³»</option>
      <option value="fun">ãŠãµã–ã‘ç³»</option>
    </select>
    <select id="sortSelect">
      <option value="default">ä¸¦ã¹æ›¿ãˆ: æ¨å¥¨é †</option>
      <option value="price-asc">ä¾¡æ ¼: å®‰ã„é †</option>
      <option value="price-desc">ä¾¡æ ¼: é«˜ã„é †</option>
      <option value="name-asc">åå‰: Aâ†’Z</option>
      <option value="name-desc">åå‰: Zâ†’A</option>
      <option value="random">ãƒ©ãƒ³ãƒ€ãƒ </option>
    </select>
    <button id="clearFilters" style="background:#333;color:white;padding:8px 10px;border-radius:8px;">ãƒ•ã‚£ãƒ«ã‚¿è§£é™¤</button>
  </div>

  <div class="plan-list" id="planList" aria-live="polite"></div>
</section>

<section id="favoritePage">
  <h2>ãŠæ°—ã«å…¥ã‚Šä¸€è¦§</h2>
  <div id="favoriteList"></div>
</section>

<section class="form-section">
  <h2>äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ </h2>

  <form id="reserveForm" novalidate>
    <input id="name" type="text" name="name" placeholder="åå‰" required>
    <input id="email" type="email" name="email" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" required>
    <input id="tel" type="text" name="tel" placeholder="é›»è©±ç•ªå·ï¼ˆä»»æ„ï¼‰">
    <input id="place" type="text" name="place" placeholder="è¡ŒããŸã„å ´æ‰€ï¼ˆå®¶ã®ä¸­ã§ã‚‚OKï¼‰" required>

    <select id="level" name="level" required>
      <option value="">è¡ŒããŸã„åº¦</option>
      <option value="0">0ï¼ˆè¡Œã‹ãªã„ï¼‰</option>
      <option value="1">1ï¼ˆã¾ã‚è¡Œã‹ãªã„ï¼‰</option>
      <option value="2">2ï¼ˆã‚„ã£ã±è¡Œã‹ãªã„ï¼‰</option>
      <option value="3">3ï¼ˆçµ¶å¯¾è¡Œã‹ãªã„ï¼‰</option>
    </select>

    <button class="submitBtn" type="submit">é€ä¿¡</button>
  </form>

  <div class="progress-container" id="progressArea">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div id="errorBox" role="alert" aria-live="assertive"></div>
  <div id="successBox" class="success" role="status" aria-live="polite"></div>
  <div id="confetti" class="confetti" aria-hidden="true"></div>
</section>

<footer style="margin-top:24px;text-align:center;opacity:0.6;">Â© 2025 StayHomeTours</footer>
</div>

<!-- èŠ±ç«ã‚­ãƒ£ãƒ³ãƒã‚¹ï¼ˆãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ï¼‰ -->
<canvas id="fireworksCanvas"></canvas>

<script>
/* ----------------------------
   ãƒ‡ãƒ¼ã‚¿ãƒ»UI åˆæœŸåŒ–ï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ»ä¾¡æ ¼æ•°å€¤ï¼‰
   ---------------------------- */
const planData = [
  {id:0,title:"å¼•ãã“ã‚‚ã‚Šæº€å–«ãƒ‘ãƒƒã‚¯",priceText:"Â¥1,980",price:1980,category:"relax",img:"https://images.unsplash.com/photo-1519710164239-da123dc03ef4",desc:"ç©¶æ¥µã®é™å¯‚ã‚’å‘³ã‚ãˆã‚‹ã€‚"},
  {id:1,title:"å¸ƒå›£ç¸›ã‚Šãƒ„ã‚¢ãƒ¼",priceText:"Â¥980",price:980,category:"comfy",img:"https://www.xyl.jp/img/products/bed_s_headboard/top_sp.jpg",desc:"å¸ƒå›£ã‹ã‚‰å‡ºãªã„æ—…è¡Œã€‚"},
  {id:2,title:"ã‚¹ãƒãƒ›ä¸–ç•Œä¸€å‘¨ãƒ—ãƒ©ãƒ³",priceText:"Â¥2,480",price:2480,category:"wild",img:"https://images.unsplash.com/photo-1504384308090-c894fdcc538d",desc:"ä¸–ç•Œã®æ™¯è‰²ã¯è¦ªæŒ‡ãŒæ±ºã‚ã‚‹ã€‚"},
  {id:3,title:"Netflixè€ä¹…æ—…",priceText:"Â¥1,500",price:1500,category:"fun",img:"https://images.unsplash.com/photo-1524985069026-dd778a71c7b4",desc:"12æ™‚é–“è¦–è´ã§è„³å†…ä¸–ç•Œæ—…è¡Œã€‚"},
  {id:4,title:"è‡ªå®¤ç§˜å¢ƒãƒˆãƒ¬ãƒƒã‚­ãƒ³ã‚°",priceText:"Â¥1,100",price:1100,category:"wild",img:"https://images.unsplash.com/photo-1500530855697-b586d89ba3ee",desc:"éƒ¨å±‹ã®éš…ã‚’æœªè¸ã®å¤§åœ°ã«ã€‚"},
  {id:5,title:"ãƒ™ãƒƒãƒ‰æ²ˆæ²¡ãƒªã‚¾ãƒ¼ãƒˆ",priceText:"Â¥2,000",price:2000,category:"comfy",img:"https://images.unsplash.com/photo-1520880867055-1e30d1cb001c",desc:"ãƒ™ãƒƒãƒ‰ã§æ²ˆã‚€è´…æ²¢ã€‚"},
  {id:6,title:"ç„¡éŸ³ç‘æƒ³ã‚¹ãƒ†ã‚¤",priceText:"Â¥980",price:980,category:"relax",img:"https://images.unsplash.com/photo-1503676260728-1c00da094a0b",desc:"é›‘éŸ³ã‚¼ãƒ­ã®å¿ƒæ—…ã€‚"},
  {id:7,title:"ã‚«ãƒ¼ãƒ†ãƒ³å¤§é™¸æ¢æ¤œ",priceText:"Â¥750",price:750,category:"wild",img:"https://images.unsplash.com/photo-1469474968028-56623f02e42e",desc:"å…‰ã¨å½±ã®ä¸–ç•Œã€‚"},
  {id:8,title:"æ·±å¤œãƒ†ãƒ³ã‚·ãƒ§ãƒ³æµ·å¤–æ—…",priceText:"Â¥1,600",price:1600,category:"fun",img:"https://www.nightview.info/photo/spot/0261/0261_04_main.jpg",desc:"å¤œã®å¦„æƒ³ã§ä¸–ç•Œæ¨ªæ–­ã€‚"},
  {id:9,title:"å®¶é›»ã‚µãƒ•ã‚¡ãƒªãƒ„ã‚¢ãƒ¼",priceText:"Â¥1,300",price:1300,category:"fun",img:"https://images.unsplash.com/photo-1481277542470-605612bd2d61",desc:"å®¶é›»ã‚’å‹•ç‰©ã«è¦‹ç«‹ã¦ã¦å†’é™ºã€‚"},
  {id:10,title:"ã‚´ãƒ­ã‚´ãƒ­æ¸©æ³‰ã”ã£ã“",priceText:"Â¥900",price:900,category:"relax",img:"https://images.unsplash.com/photo-1519824145371-296894a0daa9",desc:"å¸ƒå›£ã®ä¸­ã§æ¸©æ³‰æ°—åˆ†ã€‚"},
  {id:11,title:"å¹»ã®ãƒãƒ¼ãƒãƒ£ãƒ«å¤–å›½èªæ—…",priceText:"Â¥2,800",price:2800,category:"wild",img:"https://images.unsplash.com/photo-1453928582365-b6ad33cbcf64",desc:"å¤–å›½èªã‚¢ãƒ—ãƒªã§ç„¡é™æ—…è¡Œã€‚"}
];

const planListEl = document.getElementById('planList');
const favoriteListEl = document.getElementById('favoriteList');
const goFavoriteBtn = document.getElementById('goFavorite');
const backToMain = document.getElementById('backToMain');
const planSection = document.getElementById('planSection');
const favoritePage = document.getElementById('favoritePage');

let favorites = JSON.parse(localStorage.getItem('sht_favorites')||'[]');
let currentFilter = 'all';
let currentSort = 'default';
let currentSearch = '';

/* render with filter/search/sort */
function getFilteredSortedData(){
  let arr = planData.slice();

  // filter
  if(currentFilter !== 'all'){
    arr = arr.filter(p=>p.category === currentFilter);
  }

  // search (title + desc)
  if(currentSearch.trim()!==''){
    const q = currentSearch.trim().toLowerCase();
    arr = arr.filter(p => (p.title + ' ' + p.desc + ' ' + p.priceText).toLowerCase().includes(q));
  }

  // sort
  switch(currentSort){
    case 'price-asc': arr.sort((a,b)=>a.price-b.price); break;
    case 'price-desc': arr.sort((a,b)=>b.price-a.price); break;
    case 'name-asc': arr.sort((a,b)=>a.title.localeCompare(b.title)); break;
    case 'name-desc': arr.sort((a,b)=>b.title.localeCompare(a.title)).reverse(); break;
    case 'random': arr.sort(()=>Math.random()-0.5); break;
    default: /* keep original order */ break;
  }
  return arr;
}

function renderPlans(){
  const data = getFilteredSortedData();
  planListEl.innerHTML = '';
  if(data.length === 0){
    planListEl.innerHTML = '<p style="opacity:0.7;padding:16px;text-align:center;">ä¸€è‡´ã™ã‚‹ãƒ—ãƒ©ãƒ³ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
    return;
  }
  data.forEach(p=>{
    const card = document.createElement('div');
    card.className = 'plan-card';
    const active = favorites.includes(String(p.id)) ? 'active' : '';
    card.innerHTML = `
      <button class="favorite-btn ${active}" data-id="${p.id}" aria-label="ãŠæ°—ã«å…¥ã‚Š">${active? 'â˜…':'â˜†'}</button>
      <img src="${p.img}" alt="${p.title}">
      <h3>${p.title}</h3>
      <div class="price">${p.priceText}</div>
      <p style="opacity:0.85">${p.desc}</p>
    `;
    planListEl.appendChild(card);
  });
}
renderPlans();

function renderFavorites(){
  favoriteListEl.innerHTML = '';
  if(favorites.length === 0){
    favoriteListEl.innerHTML = '<p style="opacity:0.7;text-align:center;padding:18px;">ãŠæ°—ã«å…¥ã‚Šã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
    return;
  }
  favorites.forEach(id=>{
    const p = planData.find(x=>x.id === Number(id));
    if(!p) return;
    const c = document.createElement('div');
    c.className = 'plan-card';
    c.innerHTML = `<img src="${p.img}" alt="${p.title}"><h3>${p.title}</h3><div class="price">${p.priceText}</div><p style="opacity:0.85">${p.desc}</p>`;
    favoriteListEl.appendChild(c);
  });
}

/* favorite click delegation */
document.addEventListener('click', (e) => {
  if(e.target.classList.contains('favorite-btn')){
    const id = String(e.target.dataset.id);
    if(!favorites.includes(id)){
      favorites.push(id);
      e.target.classList.add('active');
      e.target.textContent = 'â˜…';
    } else {
      favorites = favorites.filter(f=>f!==id);
      e.target.classList.remove('active');
      e.target.textContent = 'â˜†';
    }
    localStorage.setItem('sht_favorites', JSON.stringify(favorites));
    renderPlans();
  }
});

/* favorite view toggle */
goFavoriteBtn.addEventListener('click', ()=> {
  planSection.style.display='none';
  favoritePage.style.display='block';
  backToMain.style.display='inline-block';
  renderFavorites();
});
backToMain.addEventListener('click', (e)=>{ e.preventDefault(); planSection.style.display='block'; favoritePage.style.display='none'; backToMain.style.display='none'; });

/* controls: search/filter/sort */
const searchInput = document.getElementById('searchInput');
const filterCategory = document.getElementById('filterCategory');
const sortSelect = document.getElementById('sortSelect');
const clearFiltersBtn = document.getElementById('clearFilters');

searchInput.addEventListener('input', (e)=>{ currentSearch = e.target.value; renderPlans(); });
filterCategory.addEventListener('change', (e)=>{ currentFilter = e.target.value; renderPlans(); });
sortSelect.addEventListener('change', (e)=>{ currentSort = e.target.value; renderPlans(); });
clearFiltersBtn.addEventListener('click', ()=>{ currentFilter='all'; currentSort='default'; currentSearch=''; searchInput.value=''; filterCategory.value='all'; sortSelect.value='default'; renderPlans(); });

/* ----------------------------
   äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ å¼·åŒ–ï¼ˆæ¤œè¨¼ãƒ»é€ä¿¡æ¼”å‡ºãƒ»35%ç¢ºç‡ï¼‰
   ---------------------------- */
const form = document.getElementById('reserveForm');
const progressArea = document.getElementById('progressArea');
const bar = document.getElementById('progressBar');
const errorBox = document.getElementById('errorBox');
const successBox = document.getElementById('successBox');
const confettiRoot = document.getElementById('confetti');

const errorReasons = [
  "ã‚µãƒ¼ãƒãƒ¼ãŒå¯è½ã¡ã—ã¾ã—ãŸã€‚","é€šä¿¡ã‚±ãƒ¼ãƒ–ãƒ«ãŒå¸ƒå›£ã«åŒ…ã¾ã‚Œã¦ã„ã¾ã™ã€‚","é€ä¿¡ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã“ã¨ã«æ°—ã¥ã„ã¦ã„ã¾ã›ã‚“ã€‚",
  "ãƒ‡ãƒ¼ã‚¿ãŒè¿·å­ã«ãªã‚Šã¾ã—ãŸã€‚","AIãŒæ•£æ­©ã«è¡Œãã¾ã—ãŸã€‚","ãƒ‘ã‚±ãƒƒãƒˆãŒæ¸‹æ»ä¸­ã§ã™ã€‚","é€ä¿¡è€…ã®æ°—é…ã‚’æ„Ÿã˜å–ã‚Œã¾ã›ã‚“ã€‚",
  "å›ç·šãŒã‚¹ãƒ¤ã‚¹ãƒ¤ã—ã¦ã„ã¾ã™ã€‚","é›»æ³¢ãŒã‚³ã‚¿ãƒ„ã«å¼•ãã“ã‚‚ã‚Šã¾ã—ãŸã€‚","å‡¦ç†æ‹…å½“ãŒã‚³ãƒ¼ãƒ’ãƒ¼ä¼‘æ†©ä¸­ã§ã™ã€‚",
  "ä¸–ç•Œç·šãŒã‚ºãƒ¬ã¾ã—ãŸã€‚","ãƒ‡ãƒ¼ã‚¿ãŒå¯è¿”ã‚Šã‚’æ‰“ã¡æã­ã¾ã—ãŸã€‚","è¡›æ˜ŸãŒãã—ã‚ƒã¿ã—ã¾ã—ãŸã€‚",
  "ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãŒåæŠ—æœŸã§ã™ã€‚","ã‚µãƒ¼ãƒãƒ¼ãŒä»Šæ—¥ã ã‘å¼•ãã“ã‚‚ã‚Šãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚","è¬ã®æ™‚ç©ºã®ã‚†ãŒã¿ãŒç™ºç”Ÿã€‚",
  "é€šä¿¡å¦–ç²¾ãŒã‚¹ãƒˆãƒ©ã‚¤ã‚­ä¸­ã€‚","AIã®ã‚„ã‚‹æ°—ã‚²ãƒ¼ã‚¸ãŒ0ã§ã™ã€‚","ãƒ«ãƒ¼ã‚¿ãƒ¼ãŒã‚¹ãƒ”ãƒ³ã—ã¦ã„ã¾ã™ã€‚",
  "ãƒ‡ãƒ¼ã‚¿ãŒå¯„ã‚Šé“ã—ã¦ã„ã¾ã™ã€‚","é€ä¿¡ãƒ›ãƒ«ãƒ¢ãƒ³ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚","æš—å·åŒ–ã®å‘ªæ–‡ãŒä¹±ã‚Œã¾ã—ãŸã€‚",
  "é€šä¿¡ãƒˆãƒ³ãƒãƒ«ã«è½ã¨ã—ç©´ãŒã‚ã‚Šã¾ã™ã€‚","ãƒ‡ãƒ¼ã‚¿ãŒæ˜¼å¯ä¸­ã§ã™ã€‚","å®‡å®™ç·šãŒé‚ªé­”ã‚’ã—ã¾ã—ãŸã€‚",
  "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ©Ÿå«ŒãŒæ‚ªã„ã§ã™ã€‚","é€ä¿¡è³‡æ ¼è©¦é¨“ã«è½ã¡ã¾ã—ãŸã€‚","å›ç·šãŒå¤¢ã‚’è¦‹ã¦ã„ã¾ã™ã€‚",
  "é›»å­ã®æµã‚ŒãŒé€†èµ°ã—ã¾ã—ãŸã€‚","æœªçŸ¥ã®ã‚¨ãƒ©ãƒ¼ãŒæœªçŸ¥ã®ã¾ã¾ã§ã™ã€‚"
];

/* simple validators */
function isEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
function isPhone(v){ if(!v) return true; return /^[0-9+\-\s()]{6,20}$/.test(v); }

/* error visual: flash + vibrate */
function screenFlash(){
  const flash = document.createElement('div');
  flash.style.position='fixed'; flash.style.top=0; flash.style.left=0;
  flash.style.width='100%'; flash.style.height='100%';
  flash.style.background='rgba(255,0,0,0.28)';
  flash.style.zIndex=9999; flash.style.pointerEvents='none';
  flash.style.animation='flash 0.35s ease-out';
  document.body.appendChild(flash);
  setTimeout(()=>flash.remove(),380);
}
function vibrateError(){
  errorBox.style.animation = 'vibrate 0.6s';
  setTimeout(()=> errorBox.style.animation = '',700);
}

/* confetti simple */
function launchConfetti(count=24){
  confettiRoot.innerHTML='';
  const colors = ['#ffd166','#ef476f','#06d6a0','#118ab2','#a7c957'];
  for(let i=0;i<count;i++){
    const el = document.createElement('div');
    const w = 6 + Math.random()*10;
    el.style.position='absolute';
    el.style.width = w + 'px';
    el.style.height = (w*1.3)+'px';
    el.style.left = (40 + Math.random()*20) + '%';
    el.style.top = '10%';
    el.style.background = colors[Math.floor(Math.random()*colors.length)];
    el.style.opacity = '0.95';
    el.style.borderRadius = '2px';
    el.style.transform = 'translateY(-20px)';
    el.style.transition = `transform ${1.8+Math.random()}s cubic-bezier(.2,.8,.2,1), left ${1.8+Math.random()}s linear, opacity 0.6s ease ${1.2+Math.random()}s`;
    confettiRoot.appendChild(el);
    setTimeout(()=> {
      el.style.transform = `translateY(${70 + Math.random()*30}vh)`;
      el.style.left = (10 + Math.random()*80) + '%';
    }, 50 + Math.random()*300);
    setTimeout(()=> el.style.opacity = '0', 1600 + Math.random()*600);
    setTimeout(()=> { try{ el.remove(); }catch(e){} }, 3000);
  }
}

/* fireworks system (canvas) */
const canvas = document.getElementById('fireworksCanvas');
const ctx = canvas.getContext('2d');
let cw, ch, fireworksRunning=false, fwAnimId=null;
function resizeCanvas(){
  cw = canvas.width = window.innerWidth;
  ch = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

/* particle classes */
class Firework {
  constructor(x, y, targetX, targetY, hue){
    this.x = x; this.y = y; this.sx = x; this.sy = y;
    this.tx = targetX; this.ty = targetY;
    this.hue = hue;
    this.distanceToTarget = Math.hypot(targetX-x, targetY-y);
    this.traveled = 0;
    this.coordinates = [];
    this.coordinateCount = 5;
    while(this.coordinateCount--) this.coordinates.push([this.x, this.y]);
    this.speed = 4 + Math.random()*2.5;
    this.angle = Math.atan2(targetY - y, targetX - x);
    this.acceleration = 1.02;
    this.brightness = 50 + Math.random()*30;
  }
  update(index, arr){
    this.coordinates.pop();
    this.coordinates.unshift([this.x, this.y]);
    const vx = Math.cos(this.angle) * this.speed;
    const vy = Math.sin(this.angle) * this.speed;
    this.x += vx;
    this.y += vy;
    this.traveled += Math.hypot(vx, vy);
    this.speed *= this.acceleration;
    // reached
    if(this.traveled >= this.distanceToTarget){
      // create particles
      createParticles(this.tx, this.ty, this.hue);
      arr.splice(index, 1);
    }
  }
  draw(){
    ctx.beginPath();
    ctx.moveTo(this.coordinates[this.coordinates.length-1][0], this.coordinates[this.coordinates.length-1][1]);
    ctx.lineTo(this.x, this.y);
    ctx.strokeStyle = 'hsl(' + this.hue + ', 100%, ' + this.brightness + '%)';
    ctx.stroke();
  }
}

class Particle {
  constructor(x, y, hue){
    this.x = x; this.y = y;
    this.coordinates = [];
    this.coordinateCount = 5;
    while(this.coordinateCount--) this.coordinates.push([this.x, this.y]);
    this.angle = Math.random()*Math.PI*2;
    this.speed = Math.random()*6 + 2;
    this.friction = 0.95;
    this.gravity = 0.06;
    this.hue = hue;
    this.brightness = 60 + Math.random()*20;
    this.alpha = 1;
    this.decay = 0.015 + Math.random()*0.02;
  }
  update(index, arr){
    this.coordinates.pop();
   
