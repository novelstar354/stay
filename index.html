<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ステイホームツアーズ</title>
 <link rel="icon" href="https://www.silhouette-illust.com/wp-content/uploads/2017/09/travel_odekake_38105-600x600.jpg" sizes="16×16" type="image/png" /> 
<style>
/* ===============================
   ステイホームツアーズ — フル統合完全版 CSS
   =============================== */
/* RESET */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family: "Noto Sans JP", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: #0f1114;
  color:#fff;
  line-height:1.45;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  padding:18px;
}

/* HEADER */
header{
  display:flex;
  gap:12px;
  align-items:center;
  justify-content:space-between;
  margin-bottom:16px;
  position:sticky;
  top:0;
  background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  padding:12px 18px;
  border-radius:10px;
  z-index:500;
}
header h1{font-size:1.25rem;margin-right:12px}
header nav{display:flex;gap:8px;align-items:center}

/* BUTTONS */
button, .btn{
  background:#222;
  color:#fff;
  border:1px solid rgba(255,255,255,0.06);
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer;
  font-weight:600;
}
button:hover, .btn:hover{background:#2b2b2b; transform:translateY(-1px);}

/* LAYOUT */
.hidden{display:none}
main{max-width:1100px;margin:20px auto 60px;padding-bottom:40px}

/* PLANS */
.plan-list{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap:18px;
  margin-top:12px;
}
.plan-item{
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
  border-radius:12px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,0.05);
  transition: transform .20s ease, box-shadow .20s ease;
  box-shadow: 0 6px 18px rgba(0,0,0,0.45);
  display:flex;
  flex-direction:column;
}
.plan-item:hover{ transform:translateY(-6px); box-shadow:0 14px 30px rgba(0,0,0,0.6) }

.plan-img{ display:block; width:100%; height:160px; object-fit:cover; background:#222; }
.plan-title{ font-size:1.05rem; padding:12px 12px 0; color:#fff; }
.plan-desc{ padding:8px 12px 14px; opacity:0.95; color:rgba(255,255,255,0.9) }

.plan-actions{
  margin-top:auto;
  display:flex;
  gap:8px;
  padding:12px;
  border-top:1px solid rgba(255,255,255,0.02);
}
.btn-fav{ background:rgba(0,0,0,0.45); border-radius:8px; padding:8px 10px; color:#fff; }
.btn-reserve{ flex:1; background:linear-gradient(90deg,#4aa3ff,#62b9ff); color:#041024; font-weight:800 }

/* FAVORITE ACTIVE */
.btn-fav.active{ color:#ffdd57; text-shadow:0 3px 8px rgba(0,0,0,0.6) }

/* FORM */
form{
  margin-top:18px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius:12px;
  padding:14px;
  border:1px solid rgba(255,255,255,0.04);
}
form label{display:block; font-size:0.95rem; margin-top:10px}
form input[type="text"],
form input[type="email"],
form input[type="tel"],
form input[type="number"],
form select{
  display:block;
  width:100%;
  padding:10px 12px;
  border-radius:8px;
  border:none;
  margin-top:6px;
  background:#ffffff;
  color:#000000;            /* ← 文字色を黒に */
  font-weight:600;
  font-size:0.98rem;
}
#send-btn{
  margin-top:12px;
  background:linear-gradient(90deg,#4aa3ff,#6cc8ff);
  color:#041024;
  font-weight:800;
  padding:12px;
  border-radius:10px;
  border:none;
}

/* SERVER UI */
#server-process{
  margin-top:12px;
  display:flex;
  gap:12px;
  align-items:center;
  flex-direction:column;
  background: rgba(255,255,255,0.02);
  padding:10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.03);
  width:100%;
}
.server-loader{
  width:100%;
  height:12px;
  background:rgba(255,255,255,0.04);
  border-radius:8px;
  overflow:hidden;
  position:relative;
}
.server-loader > div{
  height:100%;
  border-radius:6px;
  background:linear-gradient(90deg,#00eaff,#ff00ff,#00ff6a);
  background-size:300% 100%;
  animation:barFlow 1.2s linear infinite;
  box-shadow:0 0 14px rgba(0,234,255,0.12), 0 0 30px rgba(255,0,255,0.06) inset;
  width:0%;
  transition:width 120ms linear;
}
@keyframes barFlow{
  0%{ background-position: 0% 0 }
  100%{ background-position: 300% 0 }
}
.server-logs{
  font-family:monospace;
  font-size:0.82rem;
  opacity:0.95;
  max-height:140px;
  overflow:auto;
  background:rgba(0,0,0,0.25);
  padding:8px;
  border-radius:6px;
  border:1px solid rgba(255,255,255,0.03);
  width:100%;
  color:#dfe;
}

/* ERROR BOX */
#error-box{
  margin-top:10px;
  background: rgba(255,0,0,0.08);
  color:#fff;
  padding:10px;
  border-radius:8px;
  border:1px solid rgba(255,0,0,0.18);
}

/* FAVORITE LIST */
#favorite-list{
  margin-top:12px;
  display:grid;
  gap:12px;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}
.fav-card{
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius:10px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,0.03);
}
.fav-card img{ width:100%; height:120px; object-fit:cover; display:block }
.fav-card .meta{ padding:10px; display:flex; justify-content:space-between; align-items:center }
.remove-fav{ background:#c33; color:white; border:none; padding:8px 10px; border-radius:8px; cursor:pointer }

/* FIREWORKS */
#fireworks-container{
  position:fixed;
  top:0; left:0;
  width:100vw; height:100vh;
  pointer-events:none;
  z-index:1200;
}
canvas.fireworks{
  position:fixed; left:0; top:0; width:100vw; height:100vh; pointer-events:none; z-index:1200; display:block;
}

/* RED ALERT */
#red-warning{
  pointer-events:none;
  position:fixed;
  inset:0;
  background:transparent;
  z-index:1300;
  opacity:0;
  transition:opacity .12s linear;
}
body.red-alert #red-warning{ background: linear-gradient(180deg, rgba(255,0,0,0.06), rgba(255,0,0,0.12)); opacity:1; animation: redPulse .5s linear infinite alternate; }
@keyframes redPulse{ 0%{ filter: hue-rotate(0deg) } 100%{ filter: hue-rotate(-10deg) } }

/* SHAKE */
.shake{
  animation: shakeAnim 0.45s linear 2;
}
@keyframes shakeAnim{
  0%{ transform:translateX(0) }
  25%{ transform:translateX(-8px) }
  50%{ transform:translateX(8px) }
  100%{ transform:translateX(0) }
}

/* RESPONSIVE */
@media(max-width:680px){
  header{flex-direction:column; align-items:flex-start; gap:8px}
  .plan-img{height:140px}
  form{padding:12px}
}

/* small */
.small-muted{opacity:0.75;font-size:0.9rem}
.back-home{margin-top:12px}
</style>
</head>
<body>

<!-- RED ALERT -->
<div id="red-warning"></div>

<!-- FIREWORKS CONTAINER -->
<div id="fireworks-container"></div>

<!-- EFFECT SOUND FILES (place audio files in sounds/) -->
<audio id="se-success" src="sounds/success.mp3" preload="auto"></audio>
<audio id="se-error" src="sounds/error.mp3" preload="auto"></audio>
<audio id="se-send" src="sounds/send.mp3" preload="auto"></audio>
<audio id="se-warning" src="sounds/warning.mp3" preload="auto"></audio>
<audio id="se-click" src="sounds/click.mp3" preload="auto"></audio>
<audio id="se-fireworks" src="sounds/fireworks.mp3" preload="auto"></audio>

<header>
  <h1>ステイホームツアーズ</h1>
  <nav>
    <button id="btn-home">ホーム</button>
    <button id="btn-favorite">お気に入り一覧</button>
    <button id="btn-alert">赤警告モード</button>
  </nav>
</header>

<main id="page-home">
  <h2>旅行プラン一覧</h2>
  <div class="plan-list" id="plan-list">
    <template id="plan-template">
      <div class="plan-item">
        <img class="plan-img" />
        <h3 class="plan-title"></h3>
        <p class="plan-desc"></p>
        <div class="plan-actions">
          <button class="btn-fav">★ お気に入り</button>
          <button class="btn-reserve">予約する</button>
        </div>
      </div>
    </template>
  </div>
</main>

<main id="page-favorite" class="hidden">
  <h2>お気に入り一覧</h2>
  <div id="favorite-list"></div>
  <button class="back-home">ホームに戻る</button>
</main>

<main id="page-form" class="hidden">
  <h2>予約フォーム</h2>
  <form id="reserve-form">
    <label>名前
      <input type="text" name="name" required>
    </label>

    <label>メールアドレス
      <input type="email" name="email" required>
    </label>

    <label>電話番号
      <input type="tel" name="tel" required>
    </label>

    <label>行きたい場所
      <select name="place" id="place-select" required>
      </select>
    </label>

    <label>行きたい度（0〜100）
      <input type="number" name="level" min="0" max="100" required>
    </label>

    <button type="submit" id="send-btn">送信</button>
  </form>

  <div id="server-process" class="hidden">
    <div class="server-loader"><div style="width:0%"></div></div>
    <p id="server-status" class="small-muted">送信中…</p>
    <div class="server-logs" id="server-logs"></div>
  </div>

  <div id="error-box" class="hidden"></div>

  <button class="back-home">ホームに戻る</button>
</main>

<script>
// =========================
// フル統合 script.js
// =========================
const STORAGE_KEY = 'stayhome_favorites_v2';

// Plan data (10+)
const PLANS = [
  { id:'p1', name:'ゆるっと在宅満喫プラン', place:'自宅', img:'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=1200&q=80' },
  { id:'p2', name:'布団から出ない最強リラックス', place:'布団', img:'data:image/jpeg;base64,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' },
  { id:'p3', name:'冷蔵庫まで散歩ツアー', place:'キッチン', img:'data:image/jpeg;base64,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' },
  { id:'p4', name:'ベランダ外気浴コース', place:'ベランダ', img:'https://images.unsplash.com/photo-1520881363902-a0ff4e722963?w=1200&q=80' },
  { id:'p5', name:'リビングまったりプラン', place:'リビング', img:'https://images.unsplash.com/photo-1505693416388-ac5ce068fe85?w=1200&q=80' },
  { id:'p6', name:'押し入れ静寂瞑想プラン', place:'押し入れ', img:'https://images.unsplash.com/photo-1524758631624-e2822e304c36?w=1200&q=80' },
  { id:'p7', name:'トイレ一人旅', place:'トイレ', img:'https://images.unsplash.com/photo-1584622650111-993a426fbf0a?w=1200&q=80' },
  { id:'p8', name:'屋根裏アドベンチャー', place:'屋根裏', img:'https://images.unsplash.com/photo-1519710164239-da123dc03ef4?w=1200&q=80' },
  { id:'p9', name:'ソファで南国リゾート', place:'ソファ', img:'https://images.unsplash.com/photo-1491553895911-0055eca6402d?w=1200&q=80' },
  { id:'p10', name:'窓辺コーヒーショップ気分', place:'窓辺', img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSuJfvymkGGCZTf4Kcf0bTC898NvFk3z_U93w&s' }
];

// Error reasons: 200 items
const ERROR_REASONS = [
"サーバーが寝落ちしました…zzz",
"通信回線が迷子になりました。",
"AIがコーヒーを飲みに行きました。",
"データが異世界転生しました。",
"行きたい度が宇宙法に抵触しました。",
"情報が量子化して消えました。",
"サーバーが軽くスネています。",
"猫がネットケーブルを抜きました。",
"データが布団にこもっています。",
"入力がイケすぎて処理不能。",
"謎の宇宙干渉を検出しました。",
"送信が光速を超えて蒸発しました。",
"AIが現実逃避でフリーズ中。",
"データが音速で逃げました。",
"フォームが哲学を始めました。",
"ブラックホールがデータを吸いました。",
"ネットワークが今日は休みたいそうです。",
"未来のあなたと競合が発生しました。",
"パケットが渋滞しています。",
"フォーム担当の猫がキーボードを踏みました。",
"送信が素早すぎて転びました。",
"サーバーがおやつ休憩中です。",
"回線が自分探しの旅へ出ました。",
"データが昼寝から帰ってきません。",
"電源ケーブルがふて寝しました。",
"存在しないはずのエラーが発生しました。",
"入力が尊すぎて処理拒否されました。",
"ブラウザが照れています。",
"通信が雨に濡れてしまいました。",
"サーバーがファッションチェック中です。",
"データがエレベーターを待っています。",
"回線がダンスを始めました。",
"メモリが海に行ってしまいました。",
"送信パケットが渋滞で遅延しました。",
"時間が時間軸で渋滞しています。",
"サーバーの占いが大凶でした。",
"データの靴が脱げました。",
"入力が妖精に奪われました。",
"ネットワークが昼食を食べています。",
"AIの気分が曇りです。",
"データがUFOにさらわれました。",
"送信が深呼吸しすぎて止まりました。",
"鍵が見つからず送信できません。",
"データが迷子の旅人になりました。",
"回線が一時帰省しています。",
"パケットが流れ星にぶつかりました。",
"入力が笑い死に寸前です。",
"サーバーがツンデレモードです。",
"通信が急に照明に反射しました。",
"AIが音楽に感動して停止しました。",
"データがスローモーションになりました。",
"送信トークンが海に流れました。",
"回線が哲学的になりました。",
"データが宝の地図になりました。",
"サーバーの忍者が休憩中です。",
"ネットワークがカフェに行ってる。",
"パケットが迷路から抜けられません。",
"送信が猫のひげで詰まりました。",
"データが漫画化されました。",
"入力が未来の自分に奪われました。",
"通信が花粉症で詰まっています。",
"サーバーの歯車が油切れです。",
"送信が演劇の練習に巻き込まれました。",
"データが折り紙になりました。",
"回線が宇宙遊泳を始めました。",
"送信がアンコールを要求されました。",
"AIが急に詩を書き始めました。",
"データが迷子の小鳥になりました。",
"送信がシステムアズリリース待ちです。",
"回線が甘いものを探しています。",
"データがコーヒーで濡れてしまいました。",
"サーバーが謎のダンスを繰り返しています。",
"送信がタイムゾーンで迷子です。",
"入力が急にシャツを脱ぎました。",
"ネットワークが夢の中です。",
"データがギャラクティック休暇中。",
"送信が忘れ物を取りに戻りました。",
"回線が宇宙猫と会話中です。",
"AIが突然ギャグを始めました。",
"データがプラネットホッピングしています。",
"送信が魔法陣で止まりました。",
"回線が珈琲ブレイクです。",
"データがパジャマを着ています。",
"送信がポエムを添えて戻ってきました。",
"ネットワークが風邪を引きました。",
"データがリハーサル中です。",
"サーバーがワープの準備中です。",
"送信パケットが迷子の旅に出た模様。",
"入力が食堂に寄り道しています。",
"データがリトライする気力を失いました。",
"回線がゆっくり歩いています。",
"送信が迷路ゲームで迷っています。",
"入力が星屑に吸い込まれました。",
"データが泥の上で昼寝中。",
"サーバーが空想にふけっています。",
"送信が小さな冒険に出ました。",
"回線が宝探しに出かけました。",
"送信が宇宙トンネルに吸い込まれました。",
"データが人生について語り始めました。",
"サーバーがカウンセリング中です。",
"送信が突然散歩に出かけました。",
"回線が歌の練習を始めました。",
"データが手紙に変わりました。",
"送信が鏡の中で迷子になりました。",
"入力が季節を勘違いしました。",
"回線がワインを探しています。",
"サーバーがサボテンに話しかけています。",
"データが虹を渡って行方不明です。",
"送信が演出過多で停止しています。",
"回線が深呼吸を忘れました。",
"データが詩人に変身しました。",
"送信が暖炉の前で休んでいます。",
"回線がシーソーにはまりました。",
"データが静かに歌っています。",
"送信が星を見るために止まりました。",
"回線がマラソンに出場中です。",
"データが写真になって残っています。",
"送信がビーチで日焼けしています。",
"回線が迷子を助けに行きました。",
"データが地下鉄で寝過ごしました。",
"送信が古本屋で寄り道しました。",
"回線がシェフ修行に出かけました。",
"データが気まぐれで詩を添付しました。",
"送信がきらきらを集めに行っています。",
"回線が宇宙パン屋に立ち寄っています。",
"データがラジオ番組に出演しました。",
"送信がピクニックに出発しました。",
"回線がパズルを解いています。",
"データがタイムカプセルに入っています。",
"送信が空想列車に乗りました。",
"回線が夜空の星を数えています。",
"データが折りたたみ傘に変化しました。",
"送信が絵画の中で休んでいます。",
"回線が木曜の気分です。",
"データが古城の鍵になりました。",
"送信がふわふわ雲に捕まりました。",
"回線が手紙を届けています。",
"データが森で迷子のリスに渡りました。",
"送信がキャンドルライトで一服中。",
"回線が月に手紙を書いています。",
"データが古い地図に印をつけました。",
"送信が小舟で漂流中です。",
"回線が詩のワークショップに参加中。",
"データが紙飛行機になって旅に出ました。",
"送信が音楽祭でアンコール待ちです。",
"回線が星の市場で買い物中。",
"データが砂時計の砂になりました。"
];
// Ensure we have exactly 200; if fewer, fill in deterministic variants
while(ERROR_REASONS.length < 200){
  ERROR_REASONS.push(`ランダムエラーコード-${ERROR_REASONS.length+1}`);
}

// Audio handling (Audio tags present in DOM)
const audioEls = {
  success: document.getElementById('se-success'),
  error: document.getElementById('se-error'),
  send: document.getElementById('se-send'),
  warning: document.getElementById('se-warning'),
  click: document.getElementById('se-click'),
  fireworks: document.getElementById('se-fireworks')
};
let audioCtx = null;
function ensureAudioCtx(){ if(!audioCtx){ try{ audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }catch(e){ audioCtx = null; } } }
function beep(f=440, dur=160, type='sine', vol=0.12){ ensureAudioCtx(); if(!audioCtx) return; const o = audioCtx.createOscillator(); const g = audioCtx.createGain(); o.type = type; o.frequency.setValueAtTime(f, audioCtx.currentTime); g.gain.setValueAtTime(vol, audioCtx.currentTime); o.connect(g); g.connect(audioCtx.destination); o.start(); setTimeout(()=>o.stop(), dur); }
function playSound(kind){
  const el = audioEls[kind];
  if(el && el.src){
    el.currentTime = 0;
    el.play().catch(()=>{ /* ignore autoplay restrictions */ });
    return;
  }
  // Fallback beeps
  if(kind==='success'){ beep(880,120); setTimeout(()=>beep(660,120),130); }
  else if(kind==='error'){ beep(200,260,'square'); }
  else if(kind==='send'){ beep(600,90); }
  else if(kind==='warning'){ beep(300,160,'sawtooth'); }
  else if(kind==='click'){ beep(1200,60,'sine',0.06); }
  else if(kind==='fireworks'){ beep(1000,90,'sine',0.08); setTimeout(()=>beep(700,120,'sine',0.06),120); }
}

/* =========================
   DOM cache
   ========================= */
const planListEl = document.querySelector('.plan-list');
const planTemplate = document.getElementById('plan-template');
const pageHome = document.getElementById('page-home');
const pageFav = document.getElementById('page-favorite');
const pageForm = document.getElementById('page-form');
const favoriteListEl = document.getElementById('favorite-list');
const btnHome = document.getElementById('btn-home');
const btnFav = document.getElementById('btn-favorite');
const btnAlert = document.getElementById('btn-alert');
const backHomeBtns = Array.from(document.querySelectorAll('.back-home'));
const form = document.getElementById('reserve-form');
const placeSelect = document.getElementById('place-select');
const serverProcess = document.getElementById('server-process');
const serverLogs = document.getElementById('server-logs');
const serverStatus = document.getElementById('server-status');
const sendBtn = document.getElementById('send-btn');
const errorBox = document.getElementById('error-box');
const fwContainer = document.getElementById('fireworks-container');

/* =========================
   Persistence (favorites)
   ========================= */
function loadFavorites(){ try{ const raw = localStorage.getItem(STORAGE_KEY); if(!raw) return []; const parsed = JSON.parse(raw); return Array.isArray(parsed) ? parsed : []; }catch(e){ console.warn('loadFavorites', e); return []; } }
function saveFavorites(arr){ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }catch(e){ console.warn('saveFavorites', e); } }
let favorites = loadFavorites();

/* =========================
   Page handling
   ========================= */
function showPage(pageEl){ [pageHome, pageFav, pageForm].forEach(p=> p && p.classList.add('hidden')); pageEl.classList.remove('hidden'); window.scrollTo({top:0,behavior:'smooth'}); }
btnHome && btnHome.addEventListener('click', ()=> { showPage(pageHome); playSound('click'); });
btnFav && btnFav.addEventListener('click', ()=> { openFavoritePage(); playSound('click'); });
btnAlert && btnAlert.addEventListener('click', ()=> { toggleRedAlert(); playSound('warning'); });
backHomeBtns.forEach(b=> b.addEventListener('click', ()=> { showPage(pageHome); playSound('click'); }));

/* =========================
   Render Plans
   ========================= */
function renderPlans(){
  if(!planListEl || !planTemplate) return;
  planListEl.innerHTML = '';
  PLANS.forEach(p=>{
    const tpl = planTemplate.content.cloneNode(true);
    const item = tpl.querySelector('.plan-item');
    const img = tpl.querySelector('.plan-img');
    const title = tpl.querySelector('.plan-title');
    const desc = tpl.querySelector('.plan-desc');
    const btnFavLocal = tpl.querySelector('.btn-fav');
    const btnReserve = tpl.querySelector('.btn-reserve');
    img.src = p.img;
    img.alt = p.name;
    title.textContent = p.name;
    desc.textContent = `場所：${p.place}`;
    if(favorites.includes(p.id)) btnFavLocal.classList.add('active');
    btnFavLocal.addEventListener('click', (ev)=>{
      ev.stopPropagation();
      toggleFavorite(p.id);
      btnFavLocal.classList.toggle('active');
      renderPlans();
      playSound('click');
    });
    btnReserve.addEventListener('click', ()=>{
      openFormWithPlan(p);
      showPage(pageForm);
      playSound('click');
    });
    planListEl.appendChild(tpl);
  });
}

/* Populate place select */
function populatePlaceSelect(){ if(!placeSelect) return; const places = Array.from(new Set(PLANS.map(p=>p.place))); placeSelect.innerHTML = `<option value="">選択してください</option>`; places.forEach(pl=>{ const opt = document.createElement('option'); opt.value = pl; opt.textContent = pl; placeSelect.appendChild(opt); }); }

/* =========================
   Favorites handling
   ========================= */
function toggleFavorite(id){
  if(favorites.includes(id)){ favorites = favorites.filter(x=> x !== id); playSound('warning'); }
  else { favorites.push(id); playSound('success'); }
  saveFavorites(favorites);
}
function openFavoritePage(){ showPage(pageFav); renderFavList(); }
function renderFavList(){
  if(!favoriteListEl) return;
  favoriteListEl.innerHTML = '';
  if(favorites.length === 0){ favoriteListEl.innerHTML = '<p>お気に入りはまだありません。</p>'; return; }
  favorites.forEach(id=>{
    const p = PLANS.find(x=> x.id === id);
    if(!p) return;
    const card = document.createElement('div');
    card.className = 'fav-card';
    card.innerHTML = `
      <img src="${p.img}" alt="${escapeHtml(p.name)}">
      <div class="meta">
        <div>
          <strong>${escapeHtml(p.name)}</strong>
          <div style="opacity:0.9">${escapeHtml(p.place)}</div>
        </div>
        <div>
          <button class="remove-fav" data-id="${p.id}">削除</button>
        </div>
      </div>
    `;
    favoriteListEl.appendChild(card);
  });
  const removes = favoriteListEl.querySelectorAll('.remove-fav');
  removes.forEach(btn=> btn.addEventListener('click', ()=>{
    const id = btn.getAttribute('data-id');
    favorites = favorites.filter(x=> x !== id);
    saveFavorites(favorites);
    renderFavList();
    renderPlans();
    playSound('click');
  }));
}

/* =========================
   Open form with plan
   ========================= */
function openFormWithPlan(plan){ showPage(pageForm); if(placeSelect) placeSelect.value = plan.place; window.scrollTo({ top: 0, behavior: 'smooth' }); }

/* =========================
   Utilities
   ========================= */
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

/* =========================
   Reservation: simulated server with 35% error
   ========================= */
const STAGES = [
  {key:'connect', label:'サーバーに接続しています…'},
  {key:'auth', label:'認証トークンを取得しています…'},
  {key:'upload', label:'データをアップロードしています…'},
  {key:'process', label:'サーバーで処理しています…'},
  {key:'final', label:'最終処理中…'}
];

if(form){
  form.addEventListener('submit', (e)=>{
    e.preventDefault();

    const name = form.elements['name'].value.trim();
    const email = form.elements['email'].value.trim();
    const tel = form.elements['tel'].value.trim();
    const place = form.elements['place'].value.trim();
    const level = form.elements['level'].value;

    if(!name || !email || !tel || !place){
      form.classList.add('shake'); setTimeout(()=> form.classList.remove('shake'), 600); playSound('error'); return;
    }

    // UI Prep
    serverProcess.classList.remove('hidden');
    serverStatus.textContent = STAGES[0].label;
    serverLogs.innerHTML = '';
    sendBtn.disabled = true;
    if(errorBox){ errorBox.classList.add('hidden'); errorBox.textContent = ''; }

    // Decide if error occurs
    const willError = Math.random() < 0.35;
    const errorStageIndex = willError ? Math.floor(Math.random() * STAGES.length) : -1;
    const errorProgressThreshold = willError ? 10 + Math.floor(Math.random()*70) : null;

    // Progress bar element
    let progress = 0;
    let currentStageIdx = 0;
    const loader = serverProcess.querySelector('.server-loader > div');
    loader.style.width = '0%';

    playSound('send');

    const interval = setInterval(()=>{
      const delta = 2 + Math.random()*6;
      progress = Math.min(100, progress + delta);
      loader.style.width = progress + '%';

      const calculatedStage = Math.min(STAGES.length - 1, Math.floor(progress / (100 / STAGES.length)));
      if(calculatedStage !== currentStageIdx){
        currentStageIdx = calculatedStage;
        serverStatus.textContent = STAGES[currentStageIdx].label;
        serverLogs.innerHTML += `[${new Date().toLocaleTimeString()}] ${STAGES[currentStageIdx].label}<br>`;
        serverLogs.scrollTop = serverLogs.scrollHeight;
      }

      // Error trigger
      if(willError && (currentStageIdx >= errorStageIndex) && progress >= errorProgressThreshold){
        clearInterval(interval);
        playSound('error');
        document.body.classList.add('shake');
        const reason = ERROR_REASONS[Math.floor(Math.random()*ERROR_REASONS.length)];
        setTimeout(()=>{
          if(errorBox){ errorBox.textContent = '❌ エラー： ' + reason; errorBox.classList.remove('hidden'); }
          serverProcess.classList.add('hidden');
          loader.style.width = '0%';
          sendBtn.disabled = false;
          document.body.classList.remove('shake');
          flashRed();
        }, 220);
        return;
      }

      if(progress >= 100){
        clearInterval(interval);
        playSound('success');
        serverStatus.textContent = '完了！';
        loader.style.width = '100%';
        serverLogs.innerHTML += `[${new Date().toLocaleTimeString()}] 完了しました。<br>`;
        setTimeout(()=>{
          serverProcess.classList.add('hidden');
          loader.style.width = '0%';
          sendBtn.disabled = false;
          form.reset();
          spawnFireworkShow();
          launchFireworksDOM(6);
          alert('予約が完了しました！');
        }, 700);
      }
    }, 160 + Math.random()*160);
  });
}

/* =========================
   Red alert
   ========================= */
let redMode = false;
function toggleRedAlert(){ redMode = !redMode; if(redMode) document.body.classList.add('red-alert'); else document.body.classList.remove('red-alert'); if(redMode) playSound('warning'); }
function flashRed(){ document.body.classList.add('red-alert'); setTimeout(()=> document.body.classList.remove('red-alert'), 900); }

/* =========================
   Fireworks (canvas)
   ========================= */
let canvas = null; let ctx = null; let particles = []; let animRunning = false;
function ensureCanvas(){
  if(!canvas){
    canvas = document.createElement('canvas');
    canvas.className = 'fireworks';
    canvas.style.position = 'fixed';
    canvas.style.left = '0';
    canvas.style.top = '0';
    canvas.style.width = '100%';
    canvas.style.height = '100%';
    canvas.style.pointerEvents = 'none';
    canvas.style.zIndex = 1300;
    fwContainer.appendChild(canvas);
    ctx = canvas.getContext('2d');
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
  }
}
function resizeCanvas(){
  if(!canvas) return;
  const dpr = window.devicePixelRatio || 1;
  canvas.width = innerWidth * dpr;
  canvas.height = innerHeight * dpr;
  canvas.style.width = innerWidth + 'px';
  canvas.style.height = innerHeight + 'px';
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
function spawnBurst(x=null, y=null){
  ensureCanvas();
  const cx = x !== null ? x : Math.random()*canvas.width;
  const cy = y !== null ? y : Math.random()*canvas.height * 0.45 + 80;
  const colors = ['#ff7777','#77ff77','#7777ff','#ffff77','#ff77ff','#ffcc77','#77ffee','#aaff77'];
  const count = 60 + Math.floor(Math.random()*100);
  for(let i=0;i<count;i++){
    const angle = Math.random()*Math.PI*2;
    const speed = Math.random()*5 + 1.2;
    particles.push({
      x: cx, y: cy,
      vx: Math.cos(angle)*speed,
      vy: Math.sin(angle)*speed,
      life: 60 + Math.floor(Math.random()*60),
      color: colors[Math.floor(Math.random()*colors.length)],
      size: 1 + Math.random()*3
    });
  }
  if(!animRunning){ animRunning = true; requestAnimationFrame(animate); }
}
function animate(){
  if(!ctx) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.x += p.vx; p.y += p.vy; p.vy += 0.03; p.vx *= 0.998; p.life--;
    ctx.globalAlpha = Math.max(0, p.life / 100);
    ctx.fillStyle = p.color;
    ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI*2); ctx.fill();
    if(Math.random() < 0.03){
      ctx.globalAlpha = 0.12;
      ctx.fillRect(p.x + (Math.random()-0.5)*6, p.y + (Math.random()-0.5)*6, 1, 1);
    }
    if(p.life <= 0) particles.splice(i,1);
  }
  ctx.globalAlpha = 1;
  if(particles.length > 0) requestAnimationFrame(animate);
  else {
    animRunning = false;
    setTimeout(()=>{ if(canvas && particles.length === 0){ try{ fwContainer.removeChild(canvas); }catch(e){} canvas = null; ctx = null; } }, 300);
  }
}
function spawnFireworkShow(){
  playSound('fireworks');
  const bursts = 3 + Math.floor(Math.random()*3);
  let i=0;
  const iv = setInterval(()=>{ spawnBurst(); i++; if(i>=bursts) clearInterval(iv); }, 220);
}
/* DOM simple fireworks */
function launchFireworksDOM(count=5){
  const container = fwContainer;
  playSound('fireworks');
  for(let i=0;i<count;i++){
    const spark = document.createElement('div');
    const x = Math.random()*100;
    const y = Math.random()*60;
    spark.style.position = 'fixed';
    spark.style.left = x + 'vw';
    spark.style.top = y + 'vh';
    spark.style.width = '4px';
    spark.style.height = '4px';
    spark.style.borderRadius = '50%';
    spark.style.background = 'white';
    spark.style.boxShadow = '0 0 12px white';
    spark.style.zIndex = 1300;
    spark.style.opacity = 1;
    spark.style.transform = 'scale(1)';
    container.appendChild(spark);
    setTimeout(()=>{ spark.style.transition = '1s ease-out'; spark.style.opacity = 0; spark.style.transform = 'scale(18)'; },20);
    setTimeout(()=> spark.remove(), 1400);
  }
}

/* =========================
   Small utils, init
   ========================= */
function $(sel, root=document){ return root.querySelector(sel); }
function $all(sel, root=document){ return Array.from(root.querySelectorAll(sel)); }

function init(){
  renderPlans();
  populatePlaceSelect();
  renderFavList();
}
init();

/* Debug API */
window._stayhome = { spawnBurst, spawnFireworkShow, toggleRedAlert, favorites, saveFavorites };

// End of script
</script>
</body>
</html>
